cmake_minimum_required(VERSION 3.15)

project(SRDrones VERSION 0.1.0 LANGUAGES CSharp)

include(CSharpUtilities)

file (STRINGS "${CMAKE_CURRENT_LIST_DIR}\\Libs\\GameLocation.txt" GameLocation)
message("Game location: ${GameLocation}")

file(GLOB_RECURSE SRMLSources
    ${CMAKE_CURRENT_LIST_DIR}/SRML/SRML/*.*
)

add_library(SRML SHARED ${SRMLSources})

set_property(TARGET SRML PROPERTY VS_CONFIGURATION_TYPE ClassLibrary)

LIST(APPEND VS_DOTNET_REFERENCES "System")

LIST(APPEND VS_DOTNET_REFERENCES "${GameLocation}\\SRML\\Libs\\0Harmony.dll")
LIST(APPEND VS_DOTNET_REFERENCES "${GameLocation}\\SRML\\Libs\\INIFileParser.dll")
LIST(APPEND VS_DOTNET_REFERENCES "${GameLocation}\\SRML\\Libs\\Newtonsoft.Json.dll")
LIST(APPEND VS_DOTNET_REFERENCES "${CMAKE_CURRENT_LIST_DIR}\\Libs\\MonomiPark.SlimeRancher.dll")

LIST(APPEND VS_DOTNET_REFERENCES "${GameLocation}\\SlimeRancher_Data\\Managed\\UnityEngine.CoreModule.dll")
LIST(APPEND VS_DOTNET_REFERENCES "${GameLocation}\\SlimeRancher_Data\\Managed\\UnityEngine.IMGUIModule.dll")
LIST(APPEND VS_DOTNET_REFERENCES "${GameLocation}\\SlimeRancher_Data\\Managed\\UnityEngine.UIModule.dll")
LIST(APPEND VS_DOTNET_REFERENCES "${GameLocation}\\SlimeRancher_Data\\Managed\\UnityEngine.AnimationModule.dll")
LIST(APPEND VS_DOTNET_REFERENCES "${GameLocation}\\SlimeRancher_Data\\Managed\\UnityEngine.AssetBundleModule.dll")
LIST(APPEND VS_DOTNET_REFERENCES "${GameLocation}\\SlimeRancher_Data\\Managed\\UnityEngine.AudioModule.dll")
LIST(APPEND VS_DOTNET_REFERENCES "${GameLocation}\\SlimeRancher_Data\\Managed\\UnityEngine.PhysicsModule.dll")
LIST(APPEND VS_DOTNET_REFERENCES "${GameLocation}\\SlimeRancher_Data\\Managed\\UnityEngine.InputLegacyModule.dll")
LIST(APPEND VS_DOTNET_REFERENCES "${GameLocation}\\SlimeRancher_Data\\Managed\\UnityEngine.ParticleSystemModule.dll")
LIST(APPEND VS_DOTNET_REFERENCES "${GameLocation}\\SlimeRancher_Data\\Managed\\UnityEngine.ParticleSystemModule.dll")

LIST(APPEND VS_DOTNET_REFERENCES "${GameLocation}\\SlimeRancher_Data\\Managed\\Unity.TextMeshPro.dll")
LIST(APPEND VS_DOTNET_REFERENCES "${GameLocation}\\SlimeRancher_Data\\Managed\\UnityEngine.UI.dll")
LIST(APPEND VS_DOTNET_REFERENCES "${GameLocation}\\SlimeRancher_Data\\Managed\\InControl.dll")

set_target_properties(SRML PROPERTIES
    VS_DOTNET_REFERENCES "${VS_DOTNET_REFERENCES}"
)

set_target_properties(SRML PROPERTIES
    VS_PACKAGE_REFERENCES "${VS_PACKAGE_REFERENCES}"
)

set_target_properties(SRML PROPERTIES
    DOTNET_TARGET_FRAMEWORK_VERSION "v4.6.1"
)




file(GLOB_RECURSE SourceFiles
    ${CMAKE_CURRENT_LIST_DIR}/Source/*.*
)

add_executable(SRDrones ${SourceFiles})

LIST(APPEND VS_DOTNET_REFERENCES "System")


set_target_properties(SRDrones PROPERTIES
    VS_DOTNET_REFERENCES "${VS_DOTNET_REFERENCES}"
)

set_target_properties(SRDrones PROPERTIES
    DOTNET_TARGET_FRAMEWORK_VERSION "v4.6.1"
)

target_compile_options(SRDrones PUBLIC "/unsafe")
